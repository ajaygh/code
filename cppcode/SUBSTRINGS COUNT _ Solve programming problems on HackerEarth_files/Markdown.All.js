var Markdown;Markdown="object"==typeof exports&&"function"==typeof require?exports:{},function(){function a(a){return a}function b(a){return!1}function c(){}function d(){}c.prototype={chain:function(b,c){var d=this[b];if(!d)throw Error("unknown hook "+b);this[b]=d===a?c:function(a){return c(d(a))}},set:function(a,b){if(!this[a])throw Error("unknown hook "+a);this[a]=b},addNoop:function(b){this[b]=a},addFalse:function(a){this[a]=b}},Markdown.HookCollection=c,d.prototype={set:function(a,b){this["s_"+a]=b},get:function(a){return this["s_"+a]}},Markdown.Converter=function(){function a(a){return a=a.replace(/^[ ]{0,3}\[(.+)\]:[ \t]*\n?[ \t]*<?(\S+?)>?(?=\s|$)[ \t]*\n?[ \t]*((\n*)["(](.+?)[")][ \t]*)?(?:\n+)/gm,function(a,b,c,d,e,f){return b=b.toLowerCase(),D.set(b,u(c)),e?d:(f&&E.set(b,f.replace(/"/g,"&quot;")),"")})}function b(a){return a=a.replace(/^(<(p|div|h[1-6]|blockquote|pre|table|dl|ol|ul|script|noscript|form|fieldset|iframe|math|ins|del)\b[^\r]*?\n<\/\2>[ \t]*(?=\n+))/gm,e),a=a.replace(/^(<(p|div|h[1-6]|blockquote|pre|table|dl|ol|ul|script|noscript|form|fieldset|iframe|math)\b[^\r]*?.*<\/\2>[ \t]*(?=\n+)\n)/gm,e),a=a.replace(/\n[ ]{0,3}((<(hr)\b([^<>])*?\/?>)[ \t]*(?=\n{2,}))/g,e),a=a.replace(/\n\n[ ]{0,3}(<!(--(?:|(?:[^>-]|-[^>])(?:[^-]|-[^-])*)--)>[ \t]*(?=\n{2,}))/g,e),a=a.replace(/(?:\n\n)([ ]{0,3}(?:<([?%])[^\r]*?\2>)[ \t]*(?=\n{2,}))/g,e)}function e(a,b){var c;return c=b.replace(/^\n+/,""),c=c.replace(/\n+$/g,""),c="\n\n~K"+(F.push(c)-1)+"K\n\n"}function f(a,c){return a=k(a),a=a.replace(/^[ ]{0,2}([ ]?\*[ ]?){3,}[ \t]*$/gm,"<hr />\n"),a=a.replace(/^[ ]{0,2}([ ]?-[ ]?){3,}[ \t]*$/gm,"<hr />\n"),a=a.replace(/^[ ]{0,2}([ ]?_[ ]?){3,}[ \t]*$/gm,"<hr />\n"),a=l(a),a=n(a),a=r(a),a=b(a),a=s(a,c)}function g(a){return a=p(a),a=h(a),a=a.replace(/\\(\\)/g,B),a=a.replace(/\\([`*_{}\[\]()>#+-.!])/g,B),a=a.replace(/(!\[(.*?)\][ ]?(?:\n[ ]*)?\[(.*?)\])()()()()/g,j),a=a.replace(/(!\[(.*?)\]\s?\([ \t]*()<?(\S+?)>?[ \t]*((['"])(.*?)\6[ \t]*)?\))/g,j),a=a.replace(/(\[((?:\[[^\]]*\]|[^\[\]])*)\][ ]?(?:\n[ ]*)?\[(.*?)\])()()()()/g,i),a=a.replace(/(\[((?:\[[^\]]*\]|[^\[\]])*)\]\([ \t]*()<?((?:\([^)]*\)|[^()])*?)>?[ \t]*((['"])(.*?)\6[ \t]*)?\))/g,i),a=a.replace(/(\[([^\[\]]+)\])()()()()()/g,i),a=v(a),a=a.replace(/~P/g,"://"),a=u(a),a=a.replace(/([\W_]|^)(\*\*|__)(?=\S)([^\r]*?\S[\*_]*)\2([\W_]|$)/g,"$1<strong>$3</strong>$4"),a=a.replace(/([\W_]|^)(\*|_)(?=\S)([^\r\*_]*?\S)\2([\W_]|$)/g,"$1<em>$3</em>$4"),a=a.replace(/  +\n/g," <br>\n")}function h(a){return a=a.replace(/(<[a-z\/!$]("[^"]*"|'[^']*'|[^'">])*>|<!(--(?:|(?:[^>-]|-[^>])(?:[^-]|-[^-])*)--)>)/gi,function(a){var b=a.replace(/(.)<\/?code>(?=.)/g,"$1`");return b=A(b,"!"==a.charAt(1)?"\\`*_/":"\\`*_")})}function i(a,b,c,d,e,f,g,h){void 0==h&&(h=""),a=c.replace(/:\/\//g,"~P"),d=d.toLowerCase();if(""==e)if(""==d&&(d=a.toLowerCase().replace(/ ?\n/g," ")),void 0!=D.get(d))e=D.get(d),void 0!=E.get(d)&&(h=E.get(d));else{if(!(-1<b.search(/\(\s*\)$/m)))return b;e=""}return e=z(e),e=A(e,"*_"),b='<a href="'+e+'"',""!=h&&(h=h.replace(/"/g,"&quot;"),h=A(h,"*_"),b+=' title="'+h+'"'),b+(">"+a+"</a>")}function j(a,b,c,d,e,f,g,h){a=c,d=d.toLowerCase(),h||(h="");if(""==e){if(""==d&&(d=a.toLowerCase().replace(/ ?\n/g," ")),void 0==D.get(d))return b;e=D.get(d),void 0!=E.get(d)&&(h=E.get(d))}return a=A(a.replace(/"/g,"&quot;"),"*_[]()"),e=A(e,"*_"),b='<img src="'+e+'" alt="'+a+'"',h=h.replace(/"/g,"&quot;"),h=A(h,"*_"),b=b+(' title="'+h+'"')+" />"}function k(a){return a=a.replace(/^(.+)[ \t]*\n=+[ \t]*\n+/gm,function(a,b){return"<h1>"+g(b)+"</h1>\n\n"}),a=a.replace(/^(.+)[ \t]*\n-+[ \t]*\n+/gm,function(a,b){return"<h2>"+g(b)+"</h2>\n\n"}),a=a.replace(/^(\#{1,6})[ \t]*(.+?)[ \t]*\#*\n+/gm,function(a,b,c){return a=b.length,"<h"+a+">"+g(c)+"</h"+a+">\n\n"})}function l(a){a+="~0";var b=/^(([ ]{0,3}([*+-]|\d+[.])[ \t]+)[^\r]+?(~0|\n{2,}(?=\S)(?![ \t]*(?:[*+-]|\d+[.])[ \t]+)))/gm;return H?a=a.replace(b,function(a,b,c){return a=-1<c.search(/[*+-]/g)?"ul":"ol",b=m(b,a),b=b.replace(/\s+$/,""),"<"+a+">"+b+"</"+a+">\n"}):(b=/(\n\n|^\n?)(([ ]{0,3}([*+-]|\d+[.])[ \t]+)[^\r]+?(~0|\n{2,}(?=\S)(?![ \t]*(?:[*+-]|\d+[.])[ \t]+)))/g,a=a.replace(b,function(a,b,c,d){return a=-1<d.search(/[*+-]/g)?"ul":"ol",c=m(c,a),b+"<"+a+">\n"+c+"</"+a+">\n"})),a=a.replace(/~0/,"")}function m(a,b){H++,a=a.replace(/\n{2,}$/,"\n");var c=I[b],d=!1;return a=(a+"~0").replace(new RegExp("(^[ \\t]*)("+c+")[ \\t]+([^\\r]+?(\\n+))(?=(~0|\\1("+c+")[ \\t]+))","gm"),function(a,b,c,e){return a=e,(b=/\n\n$/.test(a))||-1<a.search(/\n{2,}/)||d?a=f(x(a),!0):(a=l(x(a)),a=a.replace(/\n$/,""),a=g(a)),d=b,"<li>"+a+"</li>\n"}),a=a.replace(/~0/g,""),H--,a}function n(a){return a=(a+"~0").replace(/(?:\n\n|^)((?:(?:[ ]{4}|\t).*\n+)+)(\n*[ ]{0,3}[^ \t\n]|(?=~0))/g,function(a,b,c){return a=q(x(b)),a=y(a),a=a.replace(/^\n+/g,""),a=a.replace(/\n+$/g,""),a="<pre><code>"+a+"\n</code></pre>","\n\n"+a+"\n\n"+c}),a=a.replace(/~0/,"")}function o(a){return a=a.replace(/(^\n+|\n+$)/g,""),"\n\n~K"+(F.push(a)-1)+"K\n\n"}function p(a){return a=a.replace(/(^|[^\\])(`+)([^\r]*?[^`])\2(?!`)/gm,function(a,b,c,d,e){return a=d.replace(/^([ \t]*)/g,""),a=a.replace(/[ \t]*$/g,""),a=q(a),a=a.replace(/:\/\//g,"~P"),b+"<code>"+a+"</code>"})}function q(a){return a=a.replace(/&/g,"&amp;"),a=a.replace(/</g,"&lt;"),a=a.replace(/>/g,"&gt;"),a=A(a,"*_{}[]\\",!1)}function r(a){return a=a.replace(/((^[ \t]*>[ \t]?.+\n(.+\n)*\n*)+)/gm,function(a,b){var c;return c=b.replace(/^[ \t]*>[ \t]?/gm,"~0"),c=c.replace(/~0/g,""),c=c.replace(/^[ \t]+$/gm,""),c=f(c),c=c.replace(/(^|\n)/g,"$1  "),c=c.replace(/(\s*<pre>[^\r]+?<\/pre>)/gm,function(a,b){var c;return c=b.replace(/^  /mg,"~0"),c=c.replace(/~0/g,"")}),o("<blockquote>\n"+c+"\n</blockquote>")})}function s(a,b){a=a.replace(/^\n+/g,""),a=a.replace(/\n+$/g,"");for(var c=a.split(/\n{2,}/g),d=[],e=/~K(\d+)K/,f=c.length,h=0;h<f;h++){var i=c[h];e.test(i)?d.push(i):/\S/.test(i)&&(i=g(i),i=i.replace(/^([ \t]*)/g,"<p>"),i+="</p>",d.push(i))}if(!b)for(f=d.length,h=0;h<f;h++)for(var j=!0;j;)j=!1,d[h]=d[h].replace(/~K(\d+)K/g,function(a,b){return j=!0,F[b]});return d.join("\n\n")}function u(a){return a=a.replace(/&(?!#?[xX]?(?:[0-9a-fA-F]+|\w+);)/g,"&amp;"),a=a.replace(/<(?![a-z\/?\$!])/gi,"&lt;")}function v(a){return a=a.replace(/(^|\s)(https?|ftp)(:\/\/[-A-Z0-9+&@#\/%?=~_|\[\]\(\)!:,\.;]*[-A-Z0-9+&@#\/%=~_|\[\]])($|\W)/gi,"$1<$2$3>$4"),a=a.replace(/<((https?|ftp):[^'">\s]+)>/gi,function(a,b){return'<a href="'+b+'">'+C.plainLinkText(b)+"</a>"})}function w(a){return a=a.replace(/~E(\d+)E/g,function(a,b){var c=parseInt(b);return String.fromCharCode(c)})}function x(a){return a=a.replace(/^(\t|[ ]{1,4})/gm,"~0"),a=a.replace(/~0/g,"")}function y(a){if(!/\t/.test(a))return a;var b=["    ","   ","  "," "],c=0,d;return a.replace(/[\n\t]/g,function(a,e){return"\n"===a?(c=e+1,a):(d=(e-c)%4,c=e+1,b[d])})}function z(a){if(!a)return"";var b=a.length;return a.replace(J,function(c,d){return"~D"==c?"%24":":"!=c||d!=b-1&&!/[0-9\/]/.test(a.charAt(d+1))?"%"+c.charCodeAt(0).toString(16):":"})}function A(a,b,c){return b="(["+b.replace(/([\[\]\\])/g,"\\$1")+"])",c&&(b="\\\\"+b),a=a.replace(new RegExp(b,"g"),B)}function B(a,b){return"~E"+b.charCodeAt(0)+"E"}var C=this.hooks=new c;C.addNoop("plainLinkText"),C.addNoop("preConversion"),C.addNoop("postConversion");var D,E,F,H;this.makeHtml=function(c){if(D)throw Error("Recursive call to converter.makeHtml");return D=new d,E=new d,F=[],H=0,c=C.preConversion(c),c=c.replace(/~/g,"~T"),c=c.replace(/\$/g,"~D"),c=c.replace(/\r\n/g,"\n"),c=c.replace(/\r/g,"\n"),c=y("\n\n"+c+"\n\n"),c=c.replace(/^[ \t]+$/mg,""),c=b(c),c=a(c),c=f(c),c=w(c),c=c.replace(/~D/g,"$$"),c=c.replace(/~T/g,"~"),c=C.postConversion(c),F=E=D=null,c};var I={ol:"\\d+[.]",ul:"[*+-]"},J=/(?:["'*()[\]:]|~D)/g}}(),function(){function a(a){return a.replace(/<[^>]*>?/gi,b)}function b(a){return a.match(f)||a.match(g)||a.match(h)?a:""}function c(a){if(""==a)return"";var b=/<\/?\w+[^>]*(\s|$|>)/g,c=a.toLowerCase().match(b),d=(c||[]).length;if(0==d)return a;for(var e,f,g,h=[],i=[],j=!1,k=0;k<d;k++)if(e=c[k].replace(/<\/?(\w+).*/,"$1"),!(h[k]||-1<"<p><img><br><li><hr>".search("<"+e+">"))){f=c[k],g=-1;if(!/^<\//.test(f))for(f=k+1;f<d;f++)if(!h[f]&&c[f]=="</"+e+">"){g=f;break}-1==g?j=i[k]=!0:h[g]=!0}return j?(k=0,a=a.replace(b,function(a){return a=i[k]?"":a,k++,a})):a}var d,e;"object"==typeof exports&&"function"==typeof require?(d=exports,e=require("./Markdown.Converter").Converter):(d=window.Markdown,e=d.Converter),d.getSanitizingConverter=function(){var b=new e;return b.hooks.chain("postConversion",a),b.hooks.chain("postConversion",c),b};var f=/^(<\/?(b|blockquote|code|del|dd|dl|dt|em|h1|h2|h3|i|kbd|li|ol|p|pre|s|sup|sub|strong|strike|ul)>|<(br|hr)\s?\/?>)$/i,g=/^(<a\shref="((https?|ftp):\/\/|\/)[-A-Za-z0-9+&@#\/%?=~_|!:,.;\(\)]+"(\stitle="[^"<>]+")?\s?>|<\/a>)$/i,h=/^(<img\ssrc="(https?:\/\/|\/)[-A-Za-z0-9+&@#\/%?=~_|!:,.;\(\)]+"(\swidth="\d{1,3}")?(\sheight="\d{1,3}")?(\salt="[^"<>]*")?(\stitle="[^"<>]*")?\s?\/?>)$/i}(),function(){function a(){}function b(a){this.buttonBar=l.getElementById("wmd-button-bar"+a),this.preview=l.getElementById("wmd-preview"+a),this.input=l.getElementById("wmd-input"+a)}function c(a,b){var c=this,e=[],f=0,g="none",h,j,k,l=function(a,b){g!=a&&(g=a,b||n()),o.isIE&&"moving"==g?k=null:j=setTimeout(m,1)},m=function(a){k=new d(b,a),j=void 0};this.setCommandMode=function(){g="command",n(),j=setTimeout(m,0)},this.canUndo=function(){return 1<f},this.canRedo=function(){return e[f+1]?!0:!1},this.undo=function(){c.canUndo()&&(h?(h.restore(),h=null):(e[f]=new d(b),e[--f].restore(),a&&a())),g="none",b.input.focus(),m()},this.redo=function(){c.canRedo()&&(e[++f].restore(),a&&a()),g="none",b.input.focus(),m()};var n=function(){var c=k||new d(b);if(!c)return!1;"moving"==g?h||(h=c):(h&&(e[f-1].text!=h.text&&(e[f++]=h),h=null),e[f++]=c,e[f+1]=null,a&&a())},p=function(a){var b=!1;if(a.ctrlKey||a.metaKey)switch(String.fromCharCode(a.charCode||a.keyCode)){case"y":c.redo(),b=!0;break;case"z":a.shiftKey?c.redo():c.undo(),b=!0}b&&(a.preventDefault&&a.preventDefault(),window.event&&(window.event.returnValue=!1))},q=function(a){a.ctrlKey||a.metaKey||(a=a.keyCode,33<=a&&40>=a||63232<=a&&63235>=a?l("moving"):8==a||46==a||127==a?l("deleting"):13==a?l("newlines"):27==a?l("escape"):(16>a||20<a)&&91!=a&&l("typing"))};(function(){i.addEvent(b.input,"keypress",function(a){!a.ctrlKey&&!a.metaKey||89!=a.keyCode&&90!=a.keyCode||a.preventDefault()});var a=function(){(o.isIE||k&&k.text!=b.input.value)&&void 0==j&&(g="paste",n(),m())};i.addEvent(b.input,"keydown",p),i.addEvent(b.input,"keydown",q),i.addEvent(b.input,"mousedown",function(){l("moving")}),b.input&&(b.input.onpaste=a,b.input.ondrop=a)})(),m(!0),n()}function d(b,c){var d=this,e=b.input;this.init=function(){i.isVisible(e)&&(c||!l.activeElement||l.activeElement===e)&&(this.setInputAreaSelectionStartEnd(),this.scrollTop=e.scrollTop,!this.text&&e.selectionStart||0===e.selectionStart)&&(this.text=e.value)},this.setInputAreaSelection=function(){if(i.isVisible(e))if(void 0!==e.selectionStart&&!o.isOpera)e.focus(),e.selectionStart=d.start,e.selectionEnd=d.end,e.scrollTop=d.scrollTop;else if(l.selection&&(!l.activeElement||l.activeElement===e)){e.focus();var a=e.createTextRange();a.moveStart("character",-e.value.length),a.moveEnd("character",-e.value.length),a.moveEnd("character",d.end),a.moveStart("character",d.start),a.select()}},this.setInputAreaSelectionStartEnd=function(){if(!b.ieCachedRange&&(e.selectionStart||0===e.selectionStart))d.start=e.selectionStart,d.end=e.selectionEnd;else if(l.selection){d.text=i.fixEolChars(e.value);var a=b.ieCachedRange||l.selection.createRange(),c=i.fixEolChars(a.text),f=""+c+"";a.text=f;var g=i.fixEolChars(e.value);a.moveStart("character",-f.length),a.text=c,d.start=g.indexOf(""),d.end=g.lastIndexOf("")-1;if(f=d.text.length-i.fixEolChars(e.value).length){for(a.moveStart("character",-c.length);f--;)c+="\n",d.end+=1;a.text=c}b.ieCachedRange&&(d.scrollTop=b.ieCachedScrollTop),b.ieCachedRange=null,this.setInputAreaSelection()}},this.restore=function(){void 0!=d.text&&d.text!=e.value&&(e.value=d.text),this.setInputAreaSelection(),e.scrollTop=d.scrollTop},this.getChunks=function(){var b=new a;return b.before=i.fixEolChars(d.text.substring(0,d.start)),b.startTag="",b.selection=i.fixEolChars(d.text.substring(d.start,d.end)),b.endTag="",b.after=i.fixEolChars(d.text.substring(d.end)),b.scrollTop=d.scrollTop,b},this.setChunks=function(a){a.before+=a.startTag,a.after=a.endTag+a.after,this.start=a.before.length,this.end=a.before.length+a.selection.length,this.text=a.before+a.selection+a.after,this.scrollTop=a.scrollTop},this.init()}function e(a,b,c){var d,e,f,g=function(){var a=0;return window.innerHeight?a=window.pageYOffset:l.documentElement&&l.documentElement.scrollTop?a=l.documentElement.scrollTop:l.body&&(a=l.body.scrollTop),a},h=function(){if(b.preview){var c=b.input.value;if(!c||c!=f){f=c;var d=(new Date).getTime(),c=a.makeHtml(c);e=(new Date).getTime()-d,t(c)}}},k=function(){d&&(clearTimeout(d),d=void 0);var a=0,a=e;3e3<a&&(a=3e3),d=setTimeout(h,a)},m=function(a){return a.scrollHeight<=a.clientHeight?1:a.scrollTop/(a.scrollHeight-a.clientHeight)};this.refresh=function(a){a?(f="",h()):k()},this.processingTime=function(){return e};var n=!0,p=function(a){var c=b.preview,d=c.parentNode,e=c.nextSibling;d.removeChild(c),c.innerHTML=a,e?d.insertBefore(c,e):d.appendChild(c)},q=function(a){b.preview.innerHTML=a},r,s=function(a){if(r)return r(a);try{q(a),r=q}catch(b){r=p,r(a)}},t=function(a){var d=j.getTop(b.input)-g();b.preview&&(s(a),c()),b.preview&&(b.preview.scrollTop=(b.preview.scrollHeight-b.preview.clientHeight)*m(b.preview));if(n)n=!1;else{var e=j.getTop(b.input)-g();o.isIE?setTimeout(function(){window.scrollBy(0,e-d)},0):window.scrollBy(0,e-d)}};(function(a,b){a&&(i.addEvent(a,"input",b),a.onpaste=b,a.ondrop=b,i.addEvent(a,"keypress",b),i.addEvent(a,"keydown",b))})(b.input,k),h(),b.preview&&(b.preview.scrollTop=0)}function f(a,b,c,e,f,g){function h(a){p.focus();if(a.textOp){c&&c.setCommandMode();var f=new d(b);if(!f)return;var g=f.getChunks(),h=function(){p.focus(),g&&f.setChunks(g),f.restore(),e.refresh()};a.textOp(g,h)||h()}a.execute&&a.execute(c)}function j(a,c){var d=a.getElementsByTagName("span")[0];c?(d.style.backgroundPosition=a.XShift+" 0px",a.onmouseover=function(){d.style.backgroundPosition=this.XShift+" -40px"},a.onmouseout=function(){d.style.backgroundPosition=this.XShift+" 0px"},o.isIE&&(a.onmousedown=function(){l.activeElement&&l.activeElement!==b.input||(b.ieCachedRange=document.selection.createRange(),b.ieCachedScrollTop=b.input.scrollTop)}),a.isHelp||(a.onclick=function(){return this.onmouseout&&this.onmouseout(),h(this),!1})):(d.style.backgroundPosition=a.XShift+" -20px",a.onmouseover=a.onmouseout=a.onclick=function(){})}function k(a){return"string"==typeof a&&(a=f[a]),function(){a.apply(f,arguments)}}function m(){c&&(j(q.undo,c.canUndo()),j(q.redo,c.canRedo()))}var p=b.input,q={};(function(){var c=b.buttonBar,d=document.createElement("ul");d.id="wmd-button-row"+a,d.className="wmd-button-row";if(c)var d=c.appendChild(d),e=0,f=function(b,c,f,g){var h=document.createElement("li");h.className="wmd-button",h.style.left=e+"px",e+=25;var i=document.createElement("span");return h.id=b+a,h.appendChild(i),h.title=c,h.XShift=f,g&&(h.textOp=g),j(h,!0),d.appendChild(h),h};c=function(b){var c=document.createElement("li");c.className="wmd-spacer wmd-spacer"+b,c.id="wmd-spacer"+b+a,d.appendChild(c),e+=25},q.bold=f("wmd-bold-button","Strong <strong> Ctrl+B","0px",k("doBold")),q.italic=f("wmd-italic-button","Emphasis <em> Ctrl+I","-20px",k("doItalic")),c(1),q.link=f("wmd-link-button","Hyperlink <a> Ctrl+L","-40px",k(function(a,b){return this.doLinkOrImage(a,b,!1)})),q.quote=f("wmd-quote-button","Blockquote <blockquote> Ctrl+Q","-60px",k("doBlockquote")),q.code=f("wmd-code-button","Code Sample <pre><code> Ctrl+K","-80px",k("doCode")),q.image=f("wmd-image-button","Image <img> Ctrl+G","-100px",k(function(a,b){return this.doLinkOrImage(a,b,!0)})),c(2),q.olist=f("wmd-olist-button","Numbered List <ol> Ctrl+O","-120px",k(function(a,b){this.doList(a,b,!0)})),q.ulist=f("wmd-ulist-button","Bulleted List <ul> Ctrl+U","-140px",k(function(a,b){this.doList(a,b,!1)})),q.heading=f("wmd-heading-button","Heading <h1>/<h2> Ctrl+H","-160px",k("doHeading")),q.hr=f("wmd-hr-button","Horizontal Rule <hr> Ctrl+R","-180px",k("doHorizontalRule")),c(3),q.undo=f("wmd-undo-button","Undo - Ctrl+Z","-200px",null),q.undo.execute=function(a){a&&a.undo()},c=/win/.test(n.platform.toLowerCase())?"Redo - Ctrl+Y":"Redo - Ctrl+Shift+Z",q.redo=f("wmd-redo-button",c,"-220px",null),q.redo.execute=function(a){a&&a.redo()},g&&(f=document.createElement("li"),c=document.createElement("span"),f.appendChild(c),f.className="wmd-button wmd-help-button",f.id="wmd-help-button"+a,f.XShift="-240px",f.isHelp=!0,f.style.right="0px",f.title=g.title||"Markdown Editing Help",f.onclick=g.handler,j(f,!0),d.appendChild(f),q.help=f),m()})();var r="keydown";o.isOpera&&(r="keypress"),i.addEvent(p,r,function(a){if((a.ctrlKey||a.metaKey)&&!a.altKey){switch(String.fromCharCode(a.charCode||a.keyCode).toLowerCase()){case"b":h(q.bold);break;case"i":h(q.italic);break;case"l":h(q.link);break;case"q":h(q.quote);break;case"k":h(q.code);break;case"g":h(q.image);break;case"o":h(q.olist);break;case"u":h(q.ulist);break;case"h":h(q.heading);break;case"r":h(q.hr);break;case"y":h(q.redo);break;case"z":a.shiftKey?h(q.redo):h(q.undo);break;default:return}a.preventDefault&&a.preventDefault(),window.event&&(window.event.returnValue=!1)}}),i.addEvent(p,"keyup",function(a){!a.shiftKey||a.ctrlKey||a.metaKey||13!==(a.charCode||a.keyCode)||(fakeButton={},fakeButton.textOp=k("doAutoindent"),h(fakeButton))}),o.isIE&&i.addEvent(p,"keydown",function(a){if(27===a.keyCode)return!1}),this.setUndoRedoButtonStates=m}function g(a){this.hooks=a}function h(a){return a.replace(/^\s*(.*?)(?:\s+"(.+)")?\s*$/,function(a,b,c){return b=b.replace(/\?.*$/,function(a){return a.replace(/\+/g," ")}),b=decodeURIComponent(b),b=encodeURI(b).replace(/'/g,"%27").replace(/\(/g,"%28").replace(/\)/g,"%29"),b=b.replace(/\?.*$/,function(a){return a.replace(/\+/g,"%2b")}),c&&(c=c.trim?c.trim():c.replace(/^\s*/,"").replace(/\s*$/,""),c=$.trim(c).replace(/"/g,"quot;").replace(/\(/g,"&#40;").replace(/\)/g,"&#41;").replace(/</g,"&lt;").replace(/>/g,"&gt;")),c?b+' "'+c+'"':b})}var i={},j={},k={},l=window.document,m=window.RegExp,n=window.navigator,o={isIE:/msie/.test(n.userAgent.toLowerCase()),isIE_5or6:/msie 6/.test(n.userAgent.toLowerCase())||/msie 5/.test(n.userAgent.toLowerCase()),isOpera:/opera/.test(n.userAgent.toLowerCase())};Markdown.Editor=function(a,d,h){d=d||"";var i=this.hooks=new Markdown.HookCollection;i.addNoop("onPreviewRefresh"),i.addNoop("postBlockquoteCreation"),i.addFalse("insertImageDialog"),this.getConverter=function(){return a};var j=this,k;this.run=function(){if(!k){k=new b(d);var m=new g(i),n=new e(a,k,function(){i.onPreviewRefresh()}),o,p;/\?noundo/.test(l.location.href)||(o=new c(function(){n.refresh(),p&&p.setUndoRedoButtonStates()},k)),p=new f(d,k,o,n,m,h),p.setUndoRedoButtonStates(),(j.refreshPreview=function(){n.refresh(!0)})()}}},a.prototype.findTags=function(a,b){var c=this,d;a&&(d=i.extendRegExp(a,"","$"),this.before=this.before.replace(d,function(a){return c.startTag+=a,""}),d=i.extendRegExp(a,"^",""),this.selection=this.selection.replace(d,function(a){return c.startTag+=a,""})),b&&(d=i.extendRegExp(b,"","$"),this.selection=this.selection.replace(d,function(a){return c.endTag=a+c.endTag,""}),d=i.extendRegExp(b,"^",""),this.after=this.after.replace(d,function(a){return c.endTag=a+c.endTag,""}))},a.prototype.trimWhitespace=function(a){var b,c=this;a?a=b="":(a=function(a){return c.before+=a,""},b=function(a){return c.after=a+c.after,""}),this.selection=this.selection.replace(/^(\s*)/,a).replace(/(\s*)$/,b)},a.prototype.skipLines=function(a,b,c){void 0===a&&(a=1),void 0===b&&(b=1),a++,b++;var d,e;navigator.userAgent.match(/Chrome/)&&"X".match(/()./),this.selection=this.selection.replace(/(^\n*)/,""),this.startTag+=m.$1,this.selection=this.selection.replace(/(\n*$)/,""),this.endTag+=m.$1,this.startTag=this.startTag.replace(/(^\n*)/,""),this.before+=m.$1,this.endTag=this.endTag.replace(/(\n*$)/,""),this.after+=m.$1;if(this.before){for(d=e="";a--;)d+="\\n?",e+="\n";c&&(d="\\n*"),this.before=this.before.replace(new m(d+"$",""),e)}if(this.after){for(d=e="";b--;)d+="\\n?",e+="\n";c&&(d="\\n*"),this.after=this.after.replace(new m(d,""),e)}},i.isVisible=function(a){if(window.getComputedStyle){try{var b="none"!==window.getComputedStyle(a,null).getPropertyValue("display")}catch(c){b=null}return b}if(a.currentStyle)return"none"!==a.currentStyle.display},i.addEvent=function(a,b,c){a&&(a.attachEvent?a.attachEvent("on"+b,c):a.addEventListener(b,c,!1))},i.removeEvent=function(a,b,c){a.detachEvent?a.detachEvent("on"+b,c):a.removeEventListener(b,c,!1)},i.fixEolChars=function(a){return a=a.replace(/\r\n/g,"\n"),a=a.replace(/\r/g,"\n")},i.extendRegExp=function(a,b,c){if(null===b||void 0===b)b="";if(null===c||void 0===c)c="";a=a.toString();var d;return a=a.replace(/\/([gim]*)$/,""),d=m.$1,a=a.replace(/(^\/|\/$)/g,""),new m(b+a+c,d)},j.getTop=function(a,b){var c=a.offsetTop;if(!b)for(;a=a.offsetParent;)c+=a.offsetTop;return c},j.getHeight=function(a){return a.offsetHeight||a.scrollHeight},j.getWidth=function(a){return a.offsetWidth||a.scrollWidth},j.getPageSize=function(){var a,b,c,d;return self.innerHeight&&self.scrollMaxY?(a=l.body.scrollWidth,b=self.innerHeight+self.scrollMaxY):l.body.scrollHeight>l.body.offsetHeight?(a=l.body.scrollWidth,b=l.body.scrollHeight):(a=l.body.offsetWidth,b=l.body.offsetHeight),self.innerHeight?(c=self.innerWidth,d=self.innerHeight):l.documentElement&&l.documentElement.clientHeight?(c=l.documentElement.clientWidth,d=l.documentElement.clientHeight):l.body&&(c=l.body.clientWidth,d=l.body.clientHeight),a=Math.max(a,c),b=Math.max(b,d),[a,b,c,d]},k.createBackground=function(){var a=l.createElement("div"),b=a.style;a.className="wmd-prompt-background",b.position="absolute",b.top="0",b.zIndex="1000",o.isIE?b.filter="alpha(opacity=50)":b.opacity="0.5";var c=j.getPageSize();return b.height=c[1]+"px",o.isIE?(b.left=l.documentElement.scrollLeft,b.width=l.documentElement.clientWidth):(b.left="0",b.width="100%"),l.body.appendChild(a),a},k.prompt=function(a,b,c){var d,e;void 0===b&&(b="");var f=function(a){27===(a.charCode||a.keyCode)&&g(!0)},g=function(a,b){i.removeEvent(l.body,"keydown",f);var g=e.value;if(b)if(a)g=null,d.parentNode.removeChild(d),c(g);else{var g=$("#filename-input").val(),h=0<=g.indexOf("\\")?g.lastIndexOf("\\"):g.lastIndexOf("/"),j=g.substring(h);if(0===j.indexOf("\\")||0===j.indexOf("/"))j=j.substring(1);g=g.substring(g.lastIndexOf(".")+1).toLowerCase();if("png"==g||"jpg"==g||"jpeg"==g||"gif"==g){$("#message_image").hide(),$("#error_image").hide(),$("#ImageUploadProgress").show();var g=document.getElementById("filename-input").files,h=document.createElement("img"),k=new FileReader;k.onload=function(a){return function(b){b=a.src=b.target.result;var e=b.split(",")[1];b.split(",")[0].split(":")[1].split("/")[1].split(";"),$.ajax({url:"/upload-image/",type:"POST",data:{type:"base64",key:"88wvr0jnjv6xapcyfdmmf5x8gl47zawv",name:j,image:e},dataType:"json",success:function(a){"ERROR"!=a.status&&(c(a.imgURL),$("#ImageUploadProgress").hide(),d.parentNode.removeChild(d))}})}}(h),k.readAsDataURL(g[0])}else $("#message_image").hide(),$("#error_image").show()}else a?(g=null,d.parentNode.removeChild(d),c(g)):(g=e.value,h=g.substring(g.lastIndexOf(".")+1).toLowerCase(),"jpg"==h||"png"==h||"jpeg"==h||"gif"==h?(g=g.replace("http://http://","http://"),g=g.replace("http://https://","https://"),g=g.replace("http://ftp://","ftp://"),-1===g.indexOf("http://")&&-1===g.indexOf("ftp://")&&-1===g.indexOf("https://")&&(g="http://"+g),d.parentNode.removeChild(d),c(g)):($("#message_url").hide(),$("#error_url").show()));return!1},h=function(){d=l.createElement("div"),d.className="wmd-prompt-dialog",d.style.padding="10px;",d.style.position="fixed",d.style.width="400px",d.style.display="block",d.style.zIndex="1001";var c=l.createElement("div"),h=c.style;c.innerHTML="image hosting by <a href = 'http://imgur.com' title='imgur: the simple image sharer' target='_blank'> imgur.com</a>",h.position="absolute",h.right="20px",h.bottom="5px",h.fontSize="10px",d.appendChild(c),h=l.createElement("div"),h.innerHTML=a,h.style.padding="5px",d.appendChild(h),h=l.createElement("p"),h.style.paddingBottom="18px",h.style.marginTop="-9px",h.style.textDecoration="none",h.style.marginLeft="70px",d.appendChild(h),c=l.createElement("a"),c.href="#",c.id="upload-image-button",c.onclick=function(){return $("#divImgForm").show(),$("#divURLForm").hide(),$("#upload-image-button").addClass("selected"),$("#upload-url-button").removeClass("selected"),!1},c.className="wmd-mini-button selected",c.innerHTML="from my computer",c.style.padding="5px",c.style.textDecoration="none",h.appendChild(c),c=l.createElement("a"),c.href="#",c.className="wmd-mini-button",c.id="upload-url-button",c.onclick=function(){return $("#divImgForm").hide(),$("#divURLForm").show(),$("#upload-url-button").addClass("selected"),$("#upload-image-button").removeClass("selected"),!1},c.innerHTML="from the web",c.style.padding="5px",c.style.textDecoration="none",h.appendChild(c);var k=l.createElement("div");k.id="divImgForm",d.appendChild(k),c=l.createElement("div"),c.id="divURLForm",c.style.display="none",d.appendChild(c);var m=l.createElement("form"),h=m.style;m.onsubmit=function(){return g(!1,!0)},m.method="post",m.enctype="multipart/form-data",h.padding="0",h.margin="0",h.marginBottom="20px",h.cssFloat="left",h.width="100%",h.textAlign="center",h.position="relative",k.appendChild(m),k=l.createElement("div"),k.id="upload-file-input",h=k.style,h.position="relative",h.height="40px",m.appendChild(k);var n=l.createElement("img");n.src="http://i.imgur.com/GKc7H.png",n.height="15",n.width="15",h=n.style,h.verticalAlign="middle",h.marginRight="6px",k.appendChild(n),n=l.createElement("input"),n.type="file",n.name="filename",n.id="filename-input",h=n.style,h.verticalAlign="middle",h.border="0",k.appendChild(n),n=l.createElement("p"),n.id="message_image",n.innerHTML="click browse to choose an image from your computer",h=n.style,k.appendChild(n),n=l.createElement("div"),n.id="ImageUploadProgress",n.innerHTML="Uploading ... <div class='image_upload_progress' style='float:right;'></div>",h=n.style,h.backgroundColor="transparent",h.marginTop="10px",h.display="none",k.appendChild(n),n=l.createElement("p"),n.id="error_image",n.innerHTML="You have not selected any file or format is not supported",h=n.style,h.color="#8B0000",h.display="none",k.appendChild(n),k=l.createElement("input"),k.type="submit",k.className="upload_button_style",k.id="uploadButton",k.onclick=function(){return g(!1,!0)},k.value="Upload",h=k.style,h.margin="10px",h.display="inline",h.width="7em",h.marginTop="18px",n=l.createElement("input"),n.type="button",n.className="upload_button_style",n.onclick=function(){return g(!0,!0)},n.value="Cancel",h=n.style,h.margin="10px",h.display="inline",h.width="7em",h.marginTop="18px",m.appendChild(k),m.appendChild(n),m=l.createElement("form"),h=m.style,m.onsubmit=function(){return g(!1,!1)},m.method="post",m.enctype="multipart/form-data",h.padding="0",h.margin="0",h.marginBottom="20px",h.cssFloat="left",h.width="100%",h.textAlign="center",h.position="relative",c.appendChild(m),c=l.createElement("div"),c.id="upload-url-input",h=c.style,h.height="40px",m.appendChild(c),e=l.createElement("input"),e.type="input",e.name="upload-url",e.value=b,h=e.style,h.display="block",h.width="80%",h.marginLeft=h.marginRight="auto",c.appendChild(e),k=l.createElement("p"),k.id="message_url",k.innerHTML="paste the URL of your image above",h=k.style,c.appendChild(k),k=l.createElement("p"),k.id="error_url",k.innerHTML="URL given is not a valid image, it should end with .jpg or .png ",h=k.style,h.color="#8B0000",h.display="none",c.appendChild(k),c=l.createElement("input"),c.type="submit",c.id="uploadButtonURL",c.className="upload_button_style",c.onclick=function(){return g(!1,!1)},c.value="Upload",h=c.style,h.margin="10px",h.display="inline",h.width="7em",h.marginTop="18px",k=l.createElement("input"),k.type="button",k.className="upload_button_style",k.onclick=function(){return g(!0,!1)},k.value="Cancel",h=k.style,h.margin="10px",h.display="inline",h.width="7em",h.marginTop="18px",m.appendChild(c),m.appendChild(k),i.addEvent(l.body,"keydown",f),d.style.top="50%",d.style.left="50%",d.style.display="block",o.isIE_5or6&&(d.style.position="absolute",d.style.top=l.documentElement.scrollTop+200+"px",d.style.left="50%"),l.body.appendChild(d),d.style.marginTop=-(j.getHeight(d)/2)+"px",d.style.marginLeft=-(j.getWidth(d)/2)+"px"};setTimeout(function(){h();var a=b.length;if(void 0!==e.selectionStart)e.selectionStart=0,e.selectionEnd=a;else if(e.createTextRange){var c=e.createTextRange();c.collapse(!1),c.moveStart("character",-a),c.moveEnd("character",a),c.select()}e.focus()},0)},k.prompt_link=function(a,b,c){var d,e;void 0===b&&(b="");var f=function(a){27===(a.charCode||a.keyCode)&&g(!0)},g=function(a){i.removeEvent(l.body,"keydown",f);var b=e.value;return a?b=null:(b=b.replace("http://http://","http://"),b=b.replace("http://https://","https://"),b=b.replace("http://ftp://","ftp://"),-1===b.indexOf("http://")&&-1===b.indexOf("ftp://")&&-1===b.indexOf("https://")&&(b="http://"+b)),d.parentNode.removeChild(d),c(b),!1},h=function(){d=l.createElement("div"),d.className="wmd-prompt-dialog",d.style.padding="10px;",d.style.position="fixed",d.style.width="400px",d.style.zIndex="1001";var c=l.createElement("div");c.innerHTML=a,c.style.padding="5px",d.appendChild(c);var c=l.createElement("form"),h=c.style;c.onsubmit=function(){return g(!1)},h.padding="0",h.margin="0",h.cssFloat="left",h.width="100%",h.textAlign="center",h.position="relative",d.appendChild(c),e=l.createElement("input"),e.type="text",e.value=b,h=e.style,h.display="block",h.width="80%",h.marginLeft=h.marginRight="auto",c.appendChild(e);var k=l.createElement("p");k.id="message_link",k.innerHTML="http://example.com/",h=k.style,c.appendChild(k),k=l.createElement("input"),k.type="button",k.className="upload_button_style",k.onclick=function(){return g(!1)},k.value="OK",h=k.style,h.margin="10px",h.display="inline",h.width="7em";var m=l.createElement("input");m.type="button",m.className="upload_button_style",m.onclick=function(){return g(!0)},m.value="Cancel",h=m.style,h.margin="10px",h.display="inline",h.width="7em",c.appendChild(k),c.appendChild(m),i.addEvent(l.body,"keydown",f),d.style.top="50%",d.style.left="50%",d.style.display="block",o.isIE_5or6&&(d.style.position="absolute",d.style.top=l.documentElement.scrollTop+200+"px",d.style.left="50%"),l.body.appendChild(d),d.style.marginTop=-(j.getHeight(d)/2)+"px",d.style.marginLeft=-(j.getWidth(d)/2)+"px"};setTimeout(function(){h();var a=b.length;if(void 0!==e.selectionStart)e.selectionStart=0,e.selectionEnd=a;else if(e.createTextRange){var c=e.createTextRange();c.collapse(!1),c.moveStart("character",-a),c.moveEnd("character",a),c.select()}e.focus()},0)};var p=g.prototype;p.prefixes="(?:\\s{4,}|\\s*>|\\s*-\\s+|\\s*\\d+\\.|=|\\+|-|_|\\*|#|\\s*\\[[^\n]]+\\]:)",p.unwrap=function(a){var b=new m("([^\\n])\\n(?!(\\n|"+this.prefixes+"))","g");a.selection=a.selection.replace(b,"$1 $2")},p.wrap=function(a,b){this.unwrap(a);var c=new m("(.{1,"+b+"})( +|$\\n?)","gm"),d=this;a.selection=a.selection.replace(c,function(a,b){return(new m("^"+d.prefixes,"")).test(a)?a:b+"\n"}),a.selection=a.selection.replace(/\s+$/,"")},p.doBold=function(a,b){return this.doBorI(a,b,2,"strong text")},p.doItalic=function(a,b){return this.doBorI(a,b,1,"emphasized text")},p.doBorI=function(a,b,c,d){a.trimWhitespace(),a.selection=a.selection.replace(/\n{2,}/g,"\n");var e=/(\**$)/.exec(a.before)[0];b=/(^\**)/.exec(a.after)[0],e=Math.min(e.length,b.length),e>=c&&(2!=e||1!=c)?(a.before=a.before.replace(m("[*]{"+c+"}$",""),""),a.after=a.after.replace(m("^[*]{"+c+"}",""),"")):!a.selection&&b?(a.after=a.after.replace(/^([*_]*)/,""),a.before=a.before.replace(/(\s?)$/,""),a.before=a.before+b+m.$1):(a.selection||b||(a.selection=d),c=1>=c?"*":"**",a.before+=c,a.after=c+a.after)},p.stripLinkDefs=function(a,b){return a=a.replace(/^[ ]{0,3}\[(\d+)\]:[ \t]*\n?[ \t]*<?(\S+?)>?[ \t]*\n?[ \t]*(?:(\n*)["(](.+?)[")][ \t]*)?(?:\n+|$)/gm,function(a,c,d,e,f){return b[c]=a.replace(/\s*$/,""),e?(b[c]=a.replace(/["(](.+?)[")]$/,""),e+f):""})},p.addLinkDef=function(a,b){var c=0,d={};a.before=this.stripLinkDefs(a.before,d),a.selection=this.stripLinkDefs(a.selection,d),a.after=this.stripLinkDefs(a.after,d);var e="",f=/(\[)((?:\[[^\]]*\]|[^\[\]])*)(\][ ]?(?:\n[ ]*)?\[)(\d+)(\])/g,g=function(a){c++,a=a.replace(/^[ ]{0,3}\[(\d+)\]:/
,"  ["+c+"]:"),e+="\n"+a},h=function(a,b,e,i,j,k){return e=e.replace(f,h),d[j]?(g(d[j]),b+e+i+c+k):a};a.before=a.before.replace(f,h),b?g(b):a.selection=a.selection.replace(f,h);var i=c;return a.after=a.after.replace(f,h),a.after&&(a.after=a.after.replace(/\n*$/,"")),a.after||(a.selection=a.selection.replace(/\n*$/,"")),a.after+="\n\n"+e,i},p.doLinkOrImage=function(a,b,c){a.trimWhitespace(),a.findTags(/\s*!?\[/,/\][ ]?(?:\n[ ]*)?(\[.*?\])?/);var d;if(1<a.endTag.length&&0<a.startTag.length)a.startTag=a.startTag.replace(/!?\[/,""),a.endTag="",this.addLinkDef(a,null);else{if(a.selection=a.startTag+a.selection+a.endTag,a.startTag=a.endTag="",!/\n\n/.test(a.selection)){var e=this,f=function(f){d.parentNode.removeChild(d),null!==f&&(a.selection=(" "+a.selection).replace(/([^\\](?:\\\\)*)(?=[[\]])/g,"$1\\").substr(1),f=" [999]: "+h(f),f=e.addLinkDef(a,f),a.startTag=c?"![":"[",a.endTag="]["+f+"]",a.selection||(a.selection=c?"enter image description here":"enter link description here")),b()};return d=k.createBackground(),c?this.hooks.insertImageDialog(f)||k.prompt("<p align='justify' style='font-size:15px;text-align: center;'><b>Insert Image</b></p>","http://",f):k.prompt_link("<p align='justify' style='font-size:15px;text-align: center;'><b>Insert Hyperlink</b></p>","http://",f),!0}this.addLinkDef(a,null)}},p.doAutoindent=function(a,b){a.before=a.before.replace(/(\n|^)[ ]{0,3}([*+-]|\d+[.])[ \t]*\n$/,"\n\n"),a.before=a.before.replace(/(\n|^)[ ]{0,3}>[ \t]*\n$/,"\n\n"),a.before=a.before.replace(/(\n|^)[ \t]+\n$/,"\n\n"),/(\n|^)[ ]{0,3}([*+-]|\d+[.])[ \t]+.*\n$/.test(a.before)&&this.doList&&this.doList(a),/(\n|^)[ ]{0,3}>[ \t]+.*\n$/.test(a.before)&&this.doBlockquote&&this.doBlockquote(a),/(\n|^)(\t|[ ]{4,}).*\n$/.test(a.before)&&this.doCode&&this.doCode(a)},p.doBlockquote=function(a,b){a.selection=a.selection.replace(/^(\n*)([^\r]+?)(\n*)$/,function(b,c,d,e){return a.before+=c,a.after=e+a.after,d}),a.before=a.before.replace(/(>[ \t]*)$/,function(b,c){return a.selection=c+a.selection,""}),a.selection=a.selection.replace(/^(\s|>)+$/,""),a.selection=a.selection||"Blockquote";var c="",d="",e;if(a.before){for(var f=a.before.replace(/\n$/,"").split("\n"),g=!1,h=0;h<f.length;h++){var i=!1;e=f[h],g=g&&0<e.length,/^>/.test(e)?(i=!0,!g&&1<e.length&&(g=!0)):i=/^[ \t]*$/.test(e)?!0:g,i?c+=e+"\n":(d+=c+e,c="\n")}/(^|\n)>/.test(c)||(d+=c,c="")}a.startTag=c,a.before=d,a.after&&(a.after=a.after.replace(/^\n?/,"\n")),a.after=a.after.replace(/^(((\n|^)(\n[ \t]*)*>(.+\n)*.*)+(\n[ \t]*)*)/,function(b){return a.endTag=b,""}),c=function(b){var c=b?"> ":"";a.startTag&&(a.startTag=a.startTag.replace(/\n((>|\s)*)\n$/,function(a,b){return"\n"+b.replace(/^[ ]{0,3}>?[ \t]*$/gm,c)+"\n"})),a.endTag&&(a.endTag=a.endTag.replace(/^\n((>|\s)*)\n/,function(a,b){return"\n"+b.replace(/^[ ]{0,3}>?[ \t]*$/gm,c)+"\n"}))},/^(?![ ]{0,3}>)/m.test(a.selection)?(this.wrap(a,70),a.selection=a.selection.replace(/^/gm,"> "),c(!0),a.skipLines()):(a.selection=a.selection.replace(/^[ ]{0,3}> ?/gm,""),this.unwrap(a),c(!1),!/^(\n|^)[ ]{0,3}>/.test(a.selection)&&a.startTag&&(a.startTag=a.startTag.replace(/\n{0,2}$/,"\n\n")),!/(\n|^)[ ]{0,3}>.*$/.test(a.selection)&&a.endTag&&(a.endTag=a.endTag.replace(/^\n{0,2}/,"\n\n"))),a.selection=this.hooks.postBlockquoteCreation(a.selection),/\n/.test(a.selection)||(a.selection=a.selection.replace(/^(> *)/,function(b,c){return a.startTag+=c,""}))},p.doCode=function(a,b){var c=/\S[ ]*$/.test(a.before);if(!/^[ ]*\S/.test(a.after)&&!c||/\n/.test(a.selection)){a.before=a.before.replace(/[ ]{4}$/,function(b){return a.selection=b+a.selection,""});var d=c=1;/\n(\t|[ ]{4,}).*\n$/.test(a.before)&&(c=0),/^\n(\t|[ ]{4,})/.test(a.after)&&(d=0),a.skipLines(c,d),a.selection?/^[ ]{0,3}\S/m.test(a.selection)?a.selection=a.selection.replace(/^/gm,"    "):a.selection=a.selection.replace(/^[ ]{4}/gm,""):(a.startTag="    ",a.selection="enter code here")}else a.trimWhitespace(),a.findTags(/`/,/`/),a.startTag||a.endTag?a.endTag&&!a.startTag?(a.before+=a.endTag,a.endTag=""):a.startTag=a.endTag="":(a.startTag=a.endTag="`",a.selection||(a.selection="enter code here"))},p.doList=function(a,b,c){b=/^\n*(([ ]{0,3}([*+-]|\d+[.])[ \t]+.*)(\n.+|\n{2,}([*+-].*|\d+[.])[ \t]+.*|\n{2,}[ \t]+\S.*)*)\n*/;var d="-",e=1,f=function(){var a;return c?(a=" "+e+". ",e++):a=" "+d+" ",a},g=function(a){return void 0===c&&(c=/^\s*\d/.test(a)),a=a.replace(/^[ ]{0,3}([*+-]|\d+[.])\s/gm,function(a){return f()})};a.findTags(/(\n|^)*[ ]{0,3}([*+-]|\d+[.])\s+/,null),!a.before||/\n$/.test(a.before)||/^\n/.test(a.startTag)||(a.before+=a.startTag,a.startTag="");if(a.startTag){var h=/\d+[.]/.test(a.startTag);a.startTag="",a.selection=a.selection.replace(/\n[ ]{4}/g,"\n"),this.unwrap(a),a.skipLines(),h&&(a.after=a.after.replace(b,g));if(c==h)return}var i=1;a.before=a.before.replace(/(\n|^)(([ ]{0,3}([*+-]|\d+[.])[ \t]+.*)(\n.+|\n{2,}([*+-].*|\d+[.])[ \t]+.*|\n{2,}[ \t]+\S.*)*)\n*$/,function(a){return/^\s*([*+-])/.test(a)&&(d=m.$1),i=/[^\n]\n\n[^\n]/.test(a)?1:0,g(a)}),a.selection||(a.selection="List item");var h=f(),j=1;a.after=a.after.replace(b,function(a){return j=/[^\n]\n\n[^\n]/.test(a)?1:0,g(a)}),a.trimWhitespace(!0),a.skipLines(i,j,!0),a.startTag=h,b=h.replace(/./g," "),this.wrap(a,72-b.length),a.selection=a.selection.replace(/\n/g,"\n"+b)},p.doHeading=function(a,b){a.selection=a.selection.replace(/\s+/g," "),a.selection=a.selection.replace(/(^\s+|\s+$)/g,"");if(a.selection){var c=0;a.findTags(/#+[ ]*/,/[ ]*#+/),/#+/.test(a.startTag)&&(c=m.lastMatch.length),a.startTag=a.endTag="",a.findTags(null,/\s?(-+|=+)/),/=+/.test(a.endTag)&&(c=1),/-+/.test(a.endTag)&&(c=2),a.startTag=a.endTag="",a.skipLines(1,1),c=0==c?2:c-1;if(0<c){var c=2<=c?"-":"=",d=a.selection.length;72<d&&(d=72);for(a.endTag="\n";d--;)a.endTag+=c}}else a.startTag="## ",a.selection="Heading",a.endTag=" ##"},p.doHorizontalRule=function(a,b){a.startTag="----------\n",a.selection="",a.skipLines(2,1,!0)}}();